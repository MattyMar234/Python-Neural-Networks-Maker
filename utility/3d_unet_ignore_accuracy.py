import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import io

# Dati forniti come stringa
data_string = """Wall time,Step,Value
1736770252.6604192,625,0.7113285660743713
1736770542.9568248,1251,0.7536138296127319
1736770832.7522166,1877,0.8198925256729126
1736771124.8899972,2503,0.6332169771194458
1736771414.8978631,3129,0.809685230255127
1736771706.7437065,3755,0.8143989443778992
1736771998.234631,4381,0.8292965292930603
1736772289.0669136,5007,0.8645484447479248
1736772580.9305985,5633,0.8606918454170227
1736772871.658251,6259,0.8604809641838074
1736773163.3590653,6885,0.8345417976379395
1736773454.3559082,7511,0.8657702207565308
1736773745.4053338,8137,0.7027571797370911
1736774032.7023642,8763,0.8699616193771362
1736774321.249913,9389,0.869475781917572
1736774612.0237408,10015,0.8546183705329895
1736774902.6695898,10641,0.8472247123718262
1736775193.7296376,11267,0.8895838260650635
1736775484.5212886,11893,0.8703023791313171
1736775775.2889698,12519,0.8808988332748413
1736776065.5458016,13145,0.8780754208564758
1736776353.9295063,13771,0.8858370184898376
1736776644.7789795,14397,0.8859255909919739
1736776935.844067,15023,0.8818994164466858
1736777224.0819893,15649,0.8960992097854614
1736777512.0991154,16275,0.869771420955658
1736777803.1440113,16901,0.8856022357940674
1736778093.2363605,17527,0.887723982334137
1736778384.3892918,18153,0.9000802636146545
1736778675.7855546,18779,0.8882517218589783
1736778967.0326507,19405,0.9037580490112305
1736779255.2250764,20031,0.8653658628463745
1736779543.140665,20657,0.8922757506370544
1736779834.7893686,21283,0.885517418384552
1736780122.5667171,21909,0.8975802063941956
1736780411.1432877,22535,0.8986960053443909
1736780702.15582,23161,0.8800428509712219
1736781158.1234407,23787,0.9084212183952332
1736781448.4317398,24413,0.9093065857887268
1736781742.1756508,25039,0.909395158290863
1736782030.1152241,25665,0.91196209192276
1736782321.1626325,26291,0.9103120565414429
1736782610.3201458,26917,0.9095582365989685
1736782900.9637952,27543,0.9113794565200806
1736783192.4339368,28169,0.9113957285881042
1736783482.8712943,28795,0.9134740829467773
1736783771.6933358,29421,0.9117446541786194
1736784060.8958814,30047,0.9091875553131104
1736784349.320128,30673,0.9133251309394836
1736784638.807695,31299,0.9126588106155396
1736784927.1470792,31925,0.9134202599525452
1736785216.534679,32551,0.9130305647850037
1736785505.9378567,33177,0.9153317213058472
1736785797.8424282,33803,0.9121827483177185
1736786087.6949892,34429,0.9104430079460144
1736786375.5098002,35055,0.9160420894622803
1736786664.2304003,35681,0.9073897004127502
1736786952.7015097,36307,0.9125767350196838
1736787312.3942428,36933,0.9148904085159302
1736787599.1449404,37559,0.9170627593994141
1736787886.5449564,38185,0.9134267568588257
1736788175.1514182,38811,0.9164301156997681
1736788461.6862679,39437,0.9153850078582764
1736788748.95168,40063,0.9122805595397949
1736789036.7708833,40689,0.9152463674545288
1736789324.277713,41315,0.9162094593048096
1736789612.022212,41941,0.9152893424034119
1736789899.954435,42567,0.9135957956314087
1736790186.9580991,43193,0.9151643514633179
1736790476.0501165,43819,0.914394199848175
1736790763.1282895,44445,0.9151926040649414
1736791052.496836,45071,0.9110756516456604
1736791340.319832,45697,0.9159339070320129
"""

# Leggere i dati utilizzando io.StringIO
values = pd.read_csv(io.StringIO(data_string))["Value"]

# Trova il valore massimo e l'indice
max_value = values.max()
max_index = values.argmax()

plt.plot(range(0, len(values)), values, marker="o",  markersize=3, color="red", label="Validation Accuracy")
plt.axhline(y=max_value, color="black", linestyle="--", linewidth=1)
plt.plot(max_index, max_value, marker="o", color="black", label=f"Max Value: {max_value:.3f}")

plt.yticks(list(plt.yticks()[0]) + [max_value])
#plt.ylim(bottom=0.0)
plt.xlim(left=0.0)

plt.xlabel("Epoch")
plt.ylabel("Validation Accuracy")
plt.legend()
plt.grid(alpha=0.5)
plt.show()
