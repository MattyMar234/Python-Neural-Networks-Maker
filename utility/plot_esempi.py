import pandas as pd
import matplotlib.pyplot as plt
from io import StringIO  # Corretto import per StringIO

# Dati dai file CSV
csv_data = [
    """avg_train_loss,avg_val_loss,epoch,learning_rate,step,val_accuracy
1.0230755805969238,0.818324863910675,0,0.0010000000474974513,4991,0.7629331350326538
0.7752912044525146,0.7235806584358215,1,0.0010000000474974513,9983,0.787043571472168
0.6950419545173645,0.6776238083839417,2,0.0010000000474974513,14975,0.8001799583435059
0.6542133688926697,0.657834529876709,3,0.0010000000474974513,19967,0.8013529181480408
0.6261106133460999,0.6459213495254517,4,0.0005000000237487257,24959,0.80568528175354
0.5665602087974548,0.5597212910652161,5,0.0005000000237487257,29951,0.8273657560348511
0.5551007390022278,0.528170645236969,6,0.0005000000237487257,34943,0.8362807631492615
0.5436981916427612,0.5304101705551147,7,0.0005000000237487257,39935,0.8355064988136292""",
    """avg_train_loss,avg_val_loss,epoch,learning_rate,step,val_accuracy
0.5315591096878052,0.5321580171585083,8,0.0005000000237487257,44927,0.8345345258712769
0.5221394300460815,0.5254326462745667,9,0.0002500000118743628,49919,0.8382462859153748
0.4990873634815216,0.486351877450943,10,0.0002500000118743628,54911,0.846401035785675
0.4918041229248047,0.48793524503707886,11,0.0002500000118743628,59903,0.8490466475486755
0.48693230748176575,0.48249542713165283,12,0.0002500000118743628,64895,0.8499611616134644
0.48323845863342285,0.4949197471141815,13,0.0002500000118743628,69887,0.8454136252403259
0.47940894961357117,0.48029351234436035,14,0.0001250000059371814,74879,0.8484272956848145
0.46729081869125366,0.47243988513946533,15,0.0001250000059371814,79871,0.851741373538971
0.4659094214439392,0.4725950062274933,16,0.0001250000059371814,84863,0.8519721627235413
0.4624861776828766,0.45728936791419983,17,0.0001250000059371814,89855,0.8554257154464722
0.4594178795814514,0.46646520495414734,18,0.0001250000059371814,94847,0.853782594203949
0.45886069536209106,0.48338621854782104,19,6.25000029685907e-05,99839,0.8491607308387756""",
    """avg_train_loss,avg_val_loss,epoch,learning_rate,step,val_accuracy
0.44762495160102844,0.4611348509788513,20,6.25000029685907e-05,104831,0.8541110157966614""",
    """avg_train_loss,avg_val_loss,epoch,learning_rate,step,val_accuracy
0.444668710231781,0.45283955335617065,21,6.25000029685907e-05,109823,0.8562431931495667
0.4476827383041382,0.47392478585243225,22,6.25000029685907e-05,114815,0.8528205156326294
0.4442959427833557,0.4448642134666443,23,6.25000029685907e-05,119807,0.8591778874397278
0.44203126430511475,0.4496685564517975,24,3.125000148429535e-05,124799,0.8583368062973022
0.44018587470054626,0.44274604320526123,25,3.125000148429535e-05,129791,0.8600664138793945
0.439974308013916,0.45441779494285583,26,3.125000148429535e-05,134783,0.8564704060554504
0.43983033299446106,0.4425346851348877,27,3.125000148429535e-05,139775,0.8595644235610962
0.4388566017150879,0.45114725828170776,28,3.125000148429535e-05,144767,0.8580156564712524"""
]

# Concatenare i dati in un unico DataFrame
dataframes = [pd.read_csv(StringIO(csv)) for csv in csv_data]
df = pd.concat(dataframes, ignore_index=True)

# Visualizzare la relazione epoca-accuratezza
plt.figure(figsize=(10, 6))
plt.plot(df['epoch'], df['val_accuracy'], marker='o', label='Validation Accuracy')
plt.xlabel('Epoch')
plt.ylabel('Validation Accuracy')
#plt.title('Epoch vs Validation Accuracy')
plt.grid(True)
plt.legend()
plt.show()
